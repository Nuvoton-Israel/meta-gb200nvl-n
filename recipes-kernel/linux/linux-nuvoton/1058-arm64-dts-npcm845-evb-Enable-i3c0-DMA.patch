From 9ea00c4ce5a2d2504d41d3b0ad02ff05b3f82da6 Mon Sep 17 00:00:00 2001
From: Stanley Chu <yschu@nuvoton.com>
Date: Mon, 15 Apr 2024 11:23:05 +0800
Subject: [PATCH 09/23] arm64: dts: npcm845-evb: Enable i3c0 DMA

Signed-off-by: Stanley Chu <yschu@nuvoton.com>
---
 .../boot/dts/nuvoton/nuvoton-common-npcm8xx.dtsi    |  5 ++++-
 arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-evb.dts | 13 +++++++------
 2 files changed, 11 insertions(+), 7 deletions(-)

diff --git a/arch/arm64/boot/dts/nuvoton/nuvoton-common-npcm8xx.dtsi b/arch/arm64/boot/dts/nuvoton/nuvoton-common-npcm8xx.dtsi
index fc4fc3c553b1..778881cfca5f 100644
--- a/arch/arm64/boot/dts/nuvoton/nuvoton-common-npcm8xx.dtsi
+++ b/arch/arm64/boot/dts/nuvoton/nuvoton-common-npcm8xx.dtsi
@@ -607,7 +607,9 @@ &fanin12_pins &fanin13_pins
 
 			i3c0: i3c@fff10000 {
 				compatible = "silvaco,i3c-master";
-				reg = <0xfff10000 0x1000>;
+				reg = <0xfff10000 0x1000>,
+				      <0xf0850000 0x1000>,
+				      <0xf0800300 0x4>;
 				pinctrl-names = "default";
 				pinctrl-0 = <&i3c0_pins
 						&i3c0_scl_slew
@@ -618,6 +620,7 @@ &i3c0_scl_slew
 				resets = <&rstc 0x74 8>;
 				#address-cells = <3>;
 				#size-cells = <0>;
+				dma-mux = <6>;
 				status = "disabled";
 			};
 
diff --git a/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-evb.dts b/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-evb.dts
index 15584438f023..e30339076a23 100644
--- a/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-evb.dts
+++ b/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-evb.dts
@@ -669,15 +669,16 @@ &i2c26 {
 };
 
 &i3c0 {
-    status = "okay";
-    i3c-scl-hz = <12500000>;
-    i2c-scl-hz = <400000>;
+	status = "okay";
+	i3c-scl-hz = <12500000>;
+	i2c-scl-hz = <400000>;
+	use-dma;
 };
 
 &i3c1 {
-    status = "okay";
-    i3c-scl-hz = <12500000>;
-    i2c-scl-hz = <400000>;
+	status = "okay";
+	i3c-scl-hz = <12500000>;
+	i2c-scl-hz = <400000>;
 };
 
 &mc {
-- 
2.43.0

